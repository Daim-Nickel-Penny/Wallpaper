 /* 
 * Wallpaper - Adds a smooth-scaling, page-filling background
 * @author Ben Plum
 * @version 1.1
 *
 * Copyright Â© 2012 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */

if(jQuery)(function(b){function p(d){a=b.extend(a,d);d=b("body");1>d.find("#wallpaper").length&&("document"==a.fitting&&(d.wrapInner('<div id="wallpaper_content" style="overflow: hidden; position: relative;"></div>'),a.$content=b("wallpaper_content")),d.append('<div id="wallpaper"></div>'),a.$wallpaper=b("#wallpaper"),a.$wallpaper.css({overflow:"hidden",minWidth:a.minWidth,top:0,width:"100%",zIndex:-1}),"document"==a.fitting?a.$wallpaper.css({position:"absolute"}):a.$wallpaper.css({height:"100%",position:"fixed"}), b(window).on("resize.wallpaper",q),l(a.file),a.onReady.call())}function l(d){if(a.$wallpaper.find("img").attr("src")!=d&&!1===k){k=!0;var c=b("<img />");c.load(function(){1>a.$wallpaper.find("img").length?(c.appendTo(a.$wallpaper),k=!1):c.css({opacity:0,"-webkit-transition":"none","-moz-transition":"none","-o-transition":"none","-ms-transition":"none",transition:"none"}).appendTo(a.$wallpaper).animate({opacity:1},a.speed,function(){a.$wallpaper.find("img").not(":last").remove();k=!1});c.css({left:"0", position:"absolute",top:"0"});m(c);a.onLoad.call()}).attr("src",d);c[0].complete&&c.trigger("load")}}function q(){$imgs=b("#wallpaper img");for(var a=0,c=$imgs.length;a<c;a++)m($imgs.eq(0))}function m(d){var c,f,h,i;c=b(window).width();var g="document"==a.fitting?b(document).height():b(window).height(),e=d[0].width;f=d[0].height;var j=e/f;i=h=0;f=g;e=f*j;e<c&&(e=c,f=e/j);h=(e-c)/2;i=(f-g)/2;"window"==a.fitting&&0<b(document).scrollLeft()&&(h+=b(document).scrollLeft());c=parseInt(e,10);f=parseInt(f, 10);h=parseInt(h,10);i=parseInt(i,10);0<d.length&&("window"==a.fitting?(g=b(window).height(),d.css({top:-i})):(e=b(document).height(),j=b(window).height(),g=a.$content.outerHeight(!0),g<e&&(g=e),j>g&&(g=j)),d.css({height:f,width:c,left:-h,top:-i}),a.$wallpaper.css({height:g}))}var a={file:null,fitting:"window",speed:"500",minWidth:!1,onReady:function(){},onLoad:function(){}},k=!1,n={update:function(a){l(a)}};b.wallpaper=function(a){return n[a]?n[a].apply(this,Array.prototype.slice.call(arguments, 1)):"object"===typeof a||!a?p.apply(this,arguments):this}})(jQuery);