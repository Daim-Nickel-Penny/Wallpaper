 /* 
 * Wallpaper - Adds a smooth-scaling, page-filling background
 * @author Ben Plum
 * @version 1.3.3
 *
 * Copyright Â© 2012 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */

if(jQuery)(function(b){function n(c){a=b.extend(a,c);c=b("body");1>c.find("#wallpaper").length&&("document"==a.fitting&&(c.wrapInner('<div id="wallpaper_content" style="overflow: hidden; position: relative;"></div>'),a.$content=b("#wallpaper_content")),c.append('<div id="wallpaper"></div>'),a.$wallpaper=b("#wallpaper"),a.$wallpaper.css({overflow:"hidden",minWidth:a.minWidth,top:0,width:"100%",zIndex:-1}),"document"==a.fitting?a.$wallpaper.css({position:"absolute"}):a.$wallpaper.css({height:"100%",position:"fixed"}), b(window).on("resize.wallpaper",p).one("load",function(){b(window).trigger("resize.wallpaper")}),k(a.file),a.onReady.call())}function k(c){if(a.$wallpaper.find("img").attr("src")!=c&&!1===g){g=!0;var d=b("<img />");d.one("load",function(){1>a.$wallpaper.find("img").length?(d.appendTo(a.$wallpaper),g=!1):d.css({opacity:0,"-webkit-transition":"none","-moz-transition":"none","-o-transition":"none","-ms-transition":"none",transition:"none"}).appendTo(a.$wallpaper).animate({opacity:1},a.speed,function(){a.$wallpaper.find("img").not(":last").remove(); g=!1});d.css({left:"0",position:"absolute",top:"0"});l(d);a.onLoad.call()}).attr("src",c);d[0].complete&&d.trigger("load")}}function p(){$imgs=b("#wallpaper img");for(var a=0,d=$imgs.length;a<d;a++)l($imgs.eq(0))}function l(c){var d,f,h,j;d=b(window).width();var i="document"==a.fitting?b(document).height():b(window).height(),e=c[0].width;f=c[0].height;var g=e/f;j=h=0;f=i;e=f*g;e<d&&(e=d,f=e/g);h=(e-d)/2;j=(f-i)/2;"window"==a.fitting&&0<b(document).scrollLeft()&&(h+=b(document).scrollLeft());d=parseInt(e, 10);f=parseInt(f,10);h=parseInt(h,10);j=parseInt(j,10);0<c.length&&("window"==a.fitting?(i=b(window).height(),c.css({top:-j})):(b(document).height(),e=b(window).height(),i=a.$content.outerHeight(!0),e>i&&(i=e)),c.css({height:f,width:d,left:-h,top:-j}),a.$wallpaper.css({height:i}))}var a={file:null,fitting:"window",speed:"500",minWidth:!1,onReady:function(){},onLoad:function(){}},g=!1,m={update:function(a){k(a)},destroy:function(){var c=b("body");c.trigger("wallpaper.beforeDestroy");"document"==a.fitting&& (c.append(a.$content.html()),a.$content.remove(),a.$content=null);a.$wallpaper.remove();a.$wallpaper=null;b(window).off(".wallpaper");c.trigger("wallpaper.afterDestroy")}};b.wallpaper=function(a){return m[a]?m[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"===typeof a||!a?n.apply(this,arguments):this}})(jQuery);